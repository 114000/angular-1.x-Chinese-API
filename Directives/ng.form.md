# `<form>`
- Angular@1.4.7
- `ng` æ¨¡å—ä¸­çš„æŒ‡ä»¤

å®ä¾‹åŒ– `FormController`(è¡¨å•æ§åˆ¶å™¨åœ¨ç±»å‹Typeç›®å½•ä¸­)çš„æŒ‡ä»¤

å¦‚æœè¡¨å•çš„ `name` å±æ€§è¢«æŒ‡å®šï¼Œé‚£ä¹ˆè¡¨å•çš„ `controller`ï¼ˆæ§åˆ¶å™¨ï¼‰ä¼šä»¥ `name`
çš„å€¼å‘½åï¼Œå¹¶è¢«å‘å¸ƒåˆ°å½“å‰çš„ä½œç”¨åŸŸä¸­ã€‚


## åˆ«å: `ngForm`

åœ¨ Angular ä¸­ï¼Œè¡¨ (`form`) æ˜¯å¯ä»¥åµŒå¥—çš„ã€‚å½“æ‰€æœ‰çš„å­—è¡¨éƒ½æœ‰æ•ˆæ—¶ï¼ˆ`valid`ï¼‰ï¼Œå¤–éƒ¨åŒ…å«ç€ä»–ä»¬çš„è¡¨æ‰æœ‰æ•ˆã€‚
ä½†æ˜¯ï¼Œæµè§ˆå™¨å®é™…ä¸Šæ˜¯ä¸æ”¯æŒ `<form>` å…ƒç´ åµŒå¥—çš„ã€‚å› æ­¤ Angular æä¾›äº† `ngForm` æŒ‡ä»¤æ¥æ”¯æŒåµŒå¥—ï¼Œ
ä¸”ä»–ä»¬çš„è¡Œä¸ºä¸ `<form>` ç›¸åŒã€‚è¿™æ ·ä½ å°±å¯ä»¥åµŒå¥—ç€ä½¿ç”¨è¡¨äº†ï¼Œå½“åœ¨è¡¨ä¸­ä½¿ç”¨äº† AngularéªŒè¯æŒ‡ä»¤æ—¶ï¼Œ
è¿™ç§æ–¹å¼ä¼šä½“ç°å‡ºå¾ˆå¤§çš„å¥½å¤„ã€‚å®ƒå¯ä»¥è¢« `ngRepeat` æŒ‡ä»¤åŠ¨æ€åœ°ç”Ÿæˆå‡ºæ¥ã€‚ç”±äºä½ ä¸èƒ½ä½¿ç”¨æ’å€¼æ¥åŠ¨æ€ç”Ÿæˆè¡¨å•
ï¼ˆ`<input>`ï¼‰å…ƒç´ çš„ `name` å±æ€§ã€‚æ‰€ä»¥ä½ ä¸å¾—ä¸ä½¿ç”¨ä¸€ä¸ª `ngForm` æŒ‡ä»¤æ¥åŒ…è£¹æ¯ç»„è¢«å¾ªç¯ï¼ˆrepeatï¼‰
å‡ºæ¥çš„è¡¨å•ï¼Œç„¶åå†ä½¿ç”¨ä¸€ä¸ªè¡¨å…ƒç´ æ¥åŒ…è£¹è¿™äº›ã€‚


## CSS ç±»

- `.ng-valid` å¦‚æœè¡¨æ˜¯**æœ‰æ•ˆçš„**ï¼Œè¿™ä¸ªCSSç±»åä¼šè¢«æ·»åŠ ã€‚
- `.ng-invalid` å¦‚æœè¡¨æ˜¯**æ— æ•ˆçš„**ï¼Œè¿™ä¸ªCSSç±»åä¼šè¢«æ·»åŠ ã€‚
- `.ng-pending` å¦‚æœè¡¨æ˜¯**å¾…å®šçš„**ï¼Œè¿™ä¸ªCSSç±»åä¼šè¢«æ·»åŠ ã€‚
- `.ng-pristine` å¦‚æœè¡¨**æ²¡æœ‰ä¿®æ”¹**ï¼Œè¿™ä¸ªCSSç±»åä¼šè¢«æ·»åŠ ã€‚
- `.ng-dirty` å¦‚æœè¡¨**ä¿®æ”¹äº†**ï¼Œè¿™ä¸ªCSSç±»åä¼šè¢«æ·»åŠ ã€‚
- `.ng-submitted` å¦‚æœè¡¨**æäº¤è¿‡äº†**ï¼Œè¿™ä¸ªCSSç±»åä¼šè¢«æ·»åŠ ã€‚

`ngAnimate` æ¨¡å—ä¼šæ£€æµ‹åˆ°è¿™äº›ç±»ä¸­æ¯ä¸€ä¸ªçš„æ·»åŠ ä¸ç§»é™¤


## æäº¤è¡¨æ•°æ®å¹¶é˜²æ­¢é»˜è®¤çš„åŠ¨ä½œ <small>([action])</small>ã€‚

ç”±äºåœ¨ Angular è®¾å¤‡ç«¯åº”ç”¨ä¸­è¡¨çš„ä»»åŠ¡ï¼ˆroleï¼‰ä¸ç”¨äºä¼ ç»Ÿçš„å¾€è¿”å‹ï¼ˆroundtripï¼‰åº”ç”¨ï¼Œç†æƒ³çš„æƒ…å†µæ˜¯ï¼Œ
ä¸éœ€è¦æµè§ˆå™¨é‡è½½æ•´ä¸ªé¡µé¢æ¥ä½¿å‘æœåŠ¡å™¨ç«¯æäº¤è¡¨å•ï¼Œè€Œæ˜¯é€šè¿‡åº”ç”¨ç‰¹å®šçš„æ–¹å¼è§¦å‘ç›¸åº”çš„ javascript
çš„é€»è¾‘æ¥å¤„ç†è¡¨å•çš„æäº¤ã€‚

å› æ­¤ï¼ŒAngular é˜»æ­¢äº†é»˜è®¤åŠ¨ä½œ(action, è¡¨æäº¤åˆ°æœåŠ¡ç«¯çš„åŠ¨ä½œ)ï¼Œé™¤éä½ ä¸º `<form>` å…ƒç´ æŒ‡å®šäº†ä¸€ä¸ª
`action` å±æ€§ã€‚

ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸¤ç§æ–¹æ³•ä¸­çš„ä»»æ„ä¸€ç§æ¥è°ƒç”¨ javascript æ–¹æ³•æ¥å®Œæˆè¡¨å•çš„æäº¤(è¯‘ï¼šè¿™ä¸ªæ–¹æ³•è‡ªå·±å†™)

- åœ¨è¡¨å…ƒç´ ä¸Š æ·»åŠ  `ngSubmit` æŒ‡ä»¤
- åœ¨ç¬¬ä¸€ä¸ªæŒ‰é’®æˆ–è€… `type` å±æ€§ä¸º `submit` çš„è¡¨å•å…ƒç´ çš„ä¸Šé¢æ·»åŠ  `ngClick` æŒ‡ä»¤

ä¸ºäº†é¿å…é‡å¤çš„æ‰§è¡Œå¤„ç†ï¼Œè¯·ç¡®ä¿ä»…ä»…ä½¿ç”¨ `ngSubmit` å’Œ `ngClick` çš„å…¶ä¸­ä¸€ä¸ªã€‚
è¿™æ ·åšçš„åŸå› æ˜¯ä¸‹é¢ç»™å‡ºçš„åœ¨ HTML è§„èŒƒä¸­ç»™å‡ºçš„è¡¨æäº¤çš„è§„åˆ™ï¼š


- å¦‚æœä¸€ä¸ªè¡¨ä¸­ä»…ä»…åªæœ‰ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œåœ¨è¿™ä¸ªè¾“å…¥æ¡†ä¸Šçš„çš„è¾“å…¥è¡Œä¸ºä¼šè§¦å‘è¡¨å•çš„æäº¤ï¼ˆ`ngSubmit`ï¼‰
- å¦‚æœä¸€ä¸ªè¡¨ä¸­æœ‰ä¸¤ä¸ªè¾“å…¥æ¡†å¹¶ä¸”æ²¡æœ‰æŒ‰é’®å’Œæäº¤æŒ‰é’®ï¼ˆ`input[type=submit]`ï¼‰ï¼Œåˆ™è¾“å…¥è¡Œä¸ºä¸ä¼šè§¦å‘è¡¨å•çš„æäº¤ã€‚
- å¦‚æœä¸€ä¸ªè¡¨ä¸­æœ‰ä¸€ä¸ªä»¥ä¸Šçš„è¾“å…¥æ¡†ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªä»¥ä¸Šçš„æŒ‰é’®æˆ–æäº¤æŒ‰é’®ï¼Œ
åˆ™åœ¨ä»»æ„ä¸€ä¸ªè¾“å…¥æ¡†ä¸Šçš„è¾“å…¥è¡Œä¸ºéƒ½å°†ä¼šè§¦å‘ç¬¬ä¸€ä¸ªæŒ‰é’®æˆ–è€…æäº¤æŒ‰é’®ä¸Šçš„å•å‡»å¤„ç†ç¨‹åºå’Œå°é—­è¡¨å•ä¸Šçš„æäº¤å¤„ç†ç¨‹åºã€‚


å½“ä¸€ä¸ªé—­åˆçš„è¡¨è¢«æäº¤äº†ï¼Œä»»ä½•å¾…å®šçš„ `ngModelOptions` çš„æ”¹å˜éƒ½ä¼šç«‹å³ç”Ÿæ•ˆã€‚éœ€è¦æ³¨æ„ `ngClick`
äº‹ä»¶å°†ä¼šåœ¨æ¨¡å‹ï¼ˆmodelï¼‰æ›´æ–°ä¹‹å‰å°±ä¼šè§¦å‘ã€‚æ‰€ä»¥ä½¿ç”¨ `ngSubmit` æ¥å…è®¸æ›´æ–°æ¨¡å‹ã€‚


## åŠ¨ç”»é’©å­

`ngForm` ä¸­çš„åŠ¨ç”»ï¼Œæ¯å½“ä»»ä½•ä¸€ä¸ªç›¸å…³è”çš„ CSS ç±»è¢«æ·»åŠ æˆ–ç§»é™¤æ—¶éƒ½ä¼šè§¦å‘ã€‚è¿™äº›ç›¸å…³çš„ç±»åŒ…æ‹¬ï¼š
`.ng-pristine`, `.ng-dirty`, `.ng-invalid` å’Œ `.ng-valid` ï¼Œè¿˜æœ‰å…¶ä»–ä¸€äº›åœ¨è¡¨ä¸­ä½¿ç”¨çš„éªŒè¯
ï¼ˆè¯‘ï¼šæ›´è¯¦ç»†çš„åœ¨**ç±»å‹-FormController** ä¸­ï¼‰ã€‚`ngForm` ä¸­çš„åŠ¨ç”»åŒ `ngClass` çš„å·¥ä½œåŸç†ä¸€è‡´ï¼Œ
åŠ¨ç”»è¡Œä¸ºä¼šè¢«é’©å–ä½¿ç”¨ CSS çš„ `transtion` åŠ¨ç”»ã€å…³é”®å¸§ï¼ˆ@keyframeï¼‰åŠ¨ç”»åŒæ ·ä¹Ÿå¯ä»¥ä½¿ç”¨ JS çš„åŠ¨ç”»ã€‚

ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†ä¸€ä¸ªåˆ©ç”¨ CSS `transtion` åŠ¨ç”»å°†è¡¨ä¸­çš„ä¸€ä¸ªè¢«éªŒè¯è¿‡ä¸ºæ— æ•ˆçš„å…ƒç´ çš„ç‰¹å®šæ ·å¼æ¸²æŸ“å‡ºæ¥çš„æ —å­ğŸŒ°ã€‚
â„(â„ â„â€¢â„Ï‰â„â€¢â„ â„)â„


``` css
/* ç¡®ä¿å¼•å…¥äº† ngAnimate æ¨¡å—å¯ä»¥æŒ‚æ¥åˆ°ä¸‹é¢çš„åŠ¨ç”»ä¸Š */
/* è¯‘ï¼šæ¨¡å—çš„å¼•å…¥,è¯·çœ‹_å…¬å…±æ–¹æ³•_ä¸­çš„_ng.angular.module_ */
.my-form {
  transition:0.5s linear all;
  background: white;
}
.my-form.ng-invalid {
  background: red;
  color:white;
}
```

## æŒ‡ä»¤ä¿¡æ¯

è¿™ä¸ªæŒ‡ä»¤çš„æ‰§è¡Œä¼˜å…ˆçº§ä¸º0çº§

## ç”¨æ³•

åƒä¸ªå…ƒç´ ï¼ˆæ ‡ç­¾ï¼‰ä¸€æ ·ä½¿ç”¨

> html

``` html
<form [name="string"]>
...
</form>
```

#### å‚æ•°

| å‚æ•° | å½¢å¼ | è¯¦ç»† |
|:----|:---:|:----|
|`name` (å¯é€‰)|`string`| è¡¨çš„åå­—ï¼Œå¦‚æœè¢«æŒ‡å®šäº†ï¼Œè¿™ä¸ªè¡¨çš„æ§åˆ¶å™¨å°±ä¼šè¢«å‘å¸ƒåˆ°å…³è”çš„ä½œç”¨åŸŸï¼ˆ`scope`ï¼‰ä¸­ã€‚|


### ä¾‹å­

> index.html

``` html
<script>
angular.module('formExample', [])
.controller('FormController', ['$scope', function($scope) {
  $scope.userType = 'guest';
}]);
</script>
<style>
 .my-form {
   transition:all linear 0.5s;
   background: transparent;
 }
 .my-form.ng-invalid {
   background: red;
 }
</style>
<form name="myForm" ng-controller="FormController" class="my-form">
  userType: <input name="input" ng-model="userType" required>
  <span class="error" ng-show="myForm.input.$error.required">Required!</span><br>
  <code>userType = {{userType}}</code><br>
  <code>myForm.input.$valid = {{myForm.input.$valid}}</code><br>
  <code>myForm.input.$error = {{myForm.input.$error}}</code><br>
  <code>myForm.$valid = {{myForm.$valid}}</code><br>
  <code>myForm.$error.required = {{!!myForm.$error.required}}</code><br>
 </form>
```

> protractor.js

```javascript
it('should initialize to model', function() {
  var userType = element(by.binding('userType'));
  var valid = element(by.binding('myForm.input.$valid'));

  expect(userType.getText()).toContain('guest');
  expect(valid.getText()).toContain('true');
});

it('should be invalid if empty', function() {
  var userType = element(by.binding('userType'));
  var valid = element(by.binding('myForm.input.$valid'));
  var userInput = element(by.model('userType'));

  userInput.clear();
  userInput.sendKeys('');

  expect(userType.getText()).toEqual('userType =');
  expect(valid.getText()).toContain('false');
});
```
